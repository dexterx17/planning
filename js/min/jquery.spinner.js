!function($){$.fn.spinner=function(opts){return this.each(function(){function changeValue(delta){textField.val(getValue()+delta),validateAndTrigger(textField)}function validateAndTrigger(field){clearTimeout(container.data("timeout"));var value=validate(field);isInvalid(value)||textField.trigger("update",[field,value])}function validate(field){var value=getValue();if(value<=options.min?decreaseButton.attr("disabled","disabled"):decreaseButton.removeAttr("disabled"),field.toggleClass("invalid",isInvalid(value)).toggleClass("passive",0===value),isInvalid(value)){var timeout=setTimeout(function(){textField.val(container.data("lastValidValue")),validate(field)},500);container.data("timeout",timeout)}else container.data("lastValidValue",value);return value}function isInvalid(value){return isNaN(+value)||value<options.min}function getValue(field){return field=field||textField,parseInt(field.val()||0,10)}var defaults={value:0,min:0},options=$.extend(defaults,opts),keyCodes={up:38,down:40},container=$("<div></div>");container.addClass("spinner");var textField=$(this).addClass("value").attr("maxlength","2").val(options.value).bind("keyup paste change",function(e){var field=$(this);e.keyCode==keyCodes.up?changeValue(1):e.keyCode==keyCodes.down?changeValue(-1):getValue(field)!=container.data("lastValidValue")&&validateAndTrigger(field)});textField.wrap(container);var increaseButton=$('<span class="increase">+</span>').click(function(){changeValue(1)}),decreaseButton=$('<span class="decrease">-</span>').click(function(){changeValue(-1)});validate(textField),container.data("lastValidValue",options.value),textField.before(decreaseButton),textField.after(increaseButton)})}}(jQuery);